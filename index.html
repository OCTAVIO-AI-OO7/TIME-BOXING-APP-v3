<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Time Boxing App</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <script src="https://unpkg.com/react@17/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@17/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
    <style>
        /* Estilos previos mantenidos */
        .sticky-header {
            position: sticky;
            top: 0;
            z-index: 10;
        }
        
        .time-column {
            position: sticky;
            left: 0;
            z-index: 5;
        }
        
        .time-header {
            position: sticky;
            left: 0;
            top: 0;
            z-index: 15;
        }
        
        /* Estilos para estados de tareas */
        .status-ongoing {
            background-color: #FEF3C7;
            color: #000000;
        }
        
        .status-done {
            background-color: #D1FAE5;
            color: #065F46;
        }
        
        /* Estilos modo oscuro actualizados */
        .dark-mode {
            color: #e5e7eb;
        }
        
        .dark-mode .app-container {
            background-color: #1f2937;
        }
        
        .dark-mode .status-ongoing {
            background-color: rgba(254, 243, 199, 0.2);
            color: #FEF3C7;
        }
        
        .dark-mode .status-done {
            background-color: rgba(209, 250, 229, 0.2);
            color: #D1FAE5;
        }

        /* Resto de estilos del modo oscuro mantenidos */
    </style>
</head>
<body class="bg-gray-100 p-4">
    <div id="root" class="container mx-auto max-w-7xl bg-white p-6 rounded-lg shadow-lg"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const TimeBoxingApp = () => {
            const [activeTab, setActiveTab] = useState('weekly');
            const [currentWeekStart, setCurrentWeekStart] = useState(getMonday(new Date()));
            const [tasks, setTasks] = useState([]);
            const [completedTasks, setCompletedTasks] = useState([]);
            const [darkMode, setDarkMode] = useState(false);
            const weekDays = ["Lunes", "Martes", "Mi√©rcoles", "Jueves", "Viernes", "S√°bado", "Domingo"];

            // Corregido: Genera time slots de 30 minutos
            function generateTimeSlots() {
                const slots = [];
                for (let i = 0; i < 24; i++) {
                    slots.push(`${String(i).padStart(2, '0')}:00`);
                    slots.push(`${String(i).padStart(2, '0')}:30`);
                }
                return slots;
            }

            // Corregido: Obtiene el lunes correcto basado en 2025
            function getMonday(d) {
                const day = d.getDay();
                const diff = d.getDate() - day + (day === 0 ? -6 : 1);
                return new Date(d.setDate(diff));
            }

            // Corregido: Manejo de fechas para 2025
            function formatDate(date) {
                return date.toISOString().split('T')[0];
            }

            // Actualizado: Manejo de tareas completadas
            const completeTask = (taskId) => {
                const task = tasks.find(t => t.id === taskId);
                if (task) {
                    const completedTask = {
                        ...task,
                        completedDate: new Date().toISOString(),
                        status: 'Done'
                    };
                    setCompletedTasks([completedTask, ...completedTasks]);
                    setTasks(tasks.filter(t => t.id !== taskId));
                }
            };

            // Actualizado: A√±adir nueva tarea
            const addTask = (day, timeSlot) => {
                const weekDates = getWeekDates();
                const dayIndex = weekDays.indexOf(day);
                const taskDate = weekDates[dayIndex];
                
                const newTask = {
                    id: Date.now(),
                    day,
                    timeSlot,
                    date: taskDate,
                    title: '',
                    priority: 'urgent_important', // Nuevo sistema de prioridades
                    status: 'On-Going',
                    completed: false
                };
                setTasks([...tasks, newTask]);
                saveToLocalStorage([...tasks, newTask], completedTasks);
            };

            // Actualizado: Sistema de prioridades
            const priorityOptions = [
                { value: 'urgent_important', label: 'Urgente + Importante' },
                { value: 'important_not_urgent', label: 'Importante + No Urgente' },
                { value: 'urgent_not_important', label: 'Urgente + No Importante' },
                { value: 'not_urgent_not_important', label: 'No Urgente + No Importante' }
            ];

            // Resto del c√≥digo (componentes UI, manejo de estado, etc.)
            // ... (Contin√∫a en la siguiente parte)
// Continuaci√≥n del componente TimeBoxingApp

            // Manejo de LocalStorage actualizado
            const saveToLocalStorage = (currentTasks, finishedTasks) => {
                localStorage.setItem('timeBoxingTasks', JSON.stringify(currentTasks));
                localStorage.setItem('timeBoxingCompletedTasks', JSON.stringify(finishedTasks));
                localStorage.setItem('timeBoxingDarkMode', JSON.stringify(darkMode));
            };

            const loadFromLocalStorage = () => {
                const savedTasks = localStorage.getItem('timeBoxingTasks');
                const savedCompletedTasks = localStorage.getItem('timeBoxingCompletedTasks');
                const savedDarkMode = localStorage.getItem('timeBoxingDarkMode');

                if (savedTasks) setTasks(JSON.parse(savedTasks));
                if (savedCompletedTasks) setCompletedTasks(JSON.parse(savedCompletedTasks));
                if (savedDarkMode !== null) setDarkMode(JSON.parse(savedDarkMode));
            };

            // Componente de Registros (nueva pesta√±a)
            const RegistersTab = () => (
                <div className={`rounded-lg p-4 shadow card`}>
                    <h2 className="text-xl font-semibold mb-4">Historial de Tareas Completadas</h2>
                    <div className="space-y-4">
                        <div className="grid grid-cols-6 gap-4 font-medium border-b pb-2">
                            <div>Tarea</div>
                            <div>D√≠a</div>
                            <div>Hora</div>
                            <div>Prioridad</div>
                            <div>Estado</div>
                            <div>Fecha Completado</div>
                        </div>
                        <div className="max-h-96 overflow-y-auto">
                            {completedTasks.map(task => (
                                <div key={task.id} className="grid grid-cols-6 gap-4 items-center border-b pb-2">
                                    <div>{task.title || 'Sin t√≠tulo'}</div>
                                    <div>{task.day}</div>
                                    <div>{task.timeSlot}</div>
                                    <div>{priorityOptions.find(p => p.value === task.priority)?.label}</div>
                                    <div className="status-done px-2 py-1 rounded text-center">
                                        {task.status}
                                    </div>
                                    <div>
                                        {new Date(task.completedDate).toLocaleDateString()}
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>
                </div>
            );

            // Componente de pesta√±as actualizado
            const TabsComponent = () => (
                <div className="flex border-b mb-4">
                    <button 
                        className={`py-2 px-4 ${activeTab === 'weekly' ? 'border-b-2 border-blue-500 font-medium' : ''}`}
                        onClick={() => setActiveTab('weekly')}
                    >
                        Planificaci√≥n Semanal
                    </button>
                    <button 
                        className={`py-2 px-4 ${activeTab === 'tasks' ? 'border-b-2 border-blue-500 font-medium' : ''}`}
                        onClick={() => setActiveTab('tasks')}
                    >
                        Registro de Tareas
                    </button>
                    <button 
                        className={`py-2 px-4 ${activeTab === 'priorities' ? 'border-b-2 border-blue-500 font-medium' : ''}`}
                        onClick={() => setActiveTab('priorities')}
                    >
                        Matriz de Prioridades
                    </button>
                    <button 
                        className={`py-2 px-4 ${activeTab === 'registers' ? 'border-b-2 border-blue-500 font-medium' : ''}`}
                        onClick={() => setActiveTab('registers')}
                    >
                        Registros
                    </button>
                </div>
            );

            // Renderizado principal del componente
            return (
                <div className={`w-full ${darkMode ? 'dark-mode' : 'bg-gray-100'}`}>
                    <div className={`p-6 rounded-lg shadow-lg app-container ${darkMode ? '' : 'bg-white'}`}>
                        <div className="flex justify-between items-center mb-6">
                            <h1 className="text-2xl font-bold">Time Boxing - Planificaci√≥n y Gesti√≥n del Tiempo</h1>
                            <button 
                                onClick={() => setDarkMode(!darkMode)}
                                className={`p-2 rounded-full ${darkMode ? 'bg-yellow-500 text-gray-900' : 'bg-gray-800 text-white'}`}
                            >
                                {darkMode ? '‚òÄÔ∏è' : 'üåô'}
                            </button>
                        </div>
                        
                        <TabsComponent />

                        {/* Contenido de las pesta√±as */}
                        {activeTab === 'registers' && <RegistersTab />}
                        {/* ... (resto de las pesta√±as se mantienen igual con las actualizaciones de estados) */}
                    </div>
                </div>
            );
        };

        ReactDOM.render(<TimeBoxingApp />, document.getElementById('root'));
    </script>
</body>
</html>
